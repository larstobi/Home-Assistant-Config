#
# Kitchen
#
kitchen_on:
  sequence:
    - service: light.turn_on
      entity_id: light.kitchen_table_ceiling_lamp_level, light.kitchen_bench_ceiling_lights_level, light.kitchen_hallway_ceiling_lights_level
      data_template:
        brightness_pct: >
          {%- if is_state('input_select.time_of_day', 'Morning') %}
            79
          {%- elif is_state('input_select.time_of_day', 'Day') %}
            99
          {%- elif is_state('input_select.time_of_day', 'Evening') %}
            60
          {%- elif is_state('input_select.time_of_day', 'Night') %}
            20
          {%- endif %}




#
# Sonos
#

sonos_tts_test:
  sequence:
    - service: script.turn_on
      entity_id: script.say_sonos
      data:
        variables:
          where: 'changing_room'
          what: 'This is a test and it is too short'

say_sonos:
  sequence:
    - service: media_player.sonos_snapshot
      data_template:
        entity_id: "{{ 'media_player.' ~ where }}"

    - service: media_player.volume_set
      data_template:
        entity_id: "{{ 'media_player.' ~ where }}"
        volume_level: 0.5

    - service: tts.google_say
      data_template:
        entity_id: "{{ 'media_player.' ~ where }}"
        message: "{{ what }}"
        language: "en-uk"

    - delay: '00:00:02'

    - wait_template: "{{ not is_state('media_player.'~where, 'playing') }}"
      timeout: '00:00:05'
      
    - delay: '00:00:01'

    - service: media_player.sonos_restore
      data_template:
        entity_id: "{{ 'media_player.' ~ where }}"
