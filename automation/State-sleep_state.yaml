###
# Control Sleep States
###
- id: '52'
  alias: 'Set house sleep state'
  trigger:
    - platform: state
      entity_id: input_select.sleep_state_ingrid, input_select.sleep_state_lande, input_select.sleep_state_tor
      to: 'Sleeping'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.sleep_state_ingrid
        state: 'Sleeping'
      - condition: state
        entity_id: input_select.sleep_state_lande
        state: 'Sleeping'
      - condition: state
        entity_id: input_select.sleep_state_tor
        state: 'Sleeping'
      - condition: state
        entity_id: input_select.home_state
        state: 'Home'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.sleep_state_house
        option: 'Sleeping'
    - service: alarm_control_panel.alarm_arm_home
      entity_id: alarm_control_panel.home_alarm
      data:
        code: !secret alarm_control_panel_code


- id: '13'
  alias: 'Final wakeup'
  trigger:
    platform: time
    at: '09:00:00'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.home_state
        state: 'Home'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.sleep_state_house, input_select.sleep_state_ingrid, input_select.sleep_state_lande, input_select.sleep_state_tor
        option: 'Awake'
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.home_alarm
      data:
        code: !secret alarm_control_panel_code

- id: '15'
  alias: 'Wake up house'
  trigger:
  - entity_id: binary_sensor.dressingroom_motion_sensor_sensor
    platform: state
    to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_select.sleep_state_house
        state: 'Sleeping'
      - condition: time
        after: '05:00:00'
        before: '20:00:00'
      - condition: state
        entity_id: input_select.home_state
        state: 'Home'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.sleep_state_house, input_select.sleep_state_ingrid, input_select.sleep_state_lande, input_select.sleep_state_tor
        option: 'Awake'
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.home_alarm
      data:
        code: !secret alarm_control_panel_code
