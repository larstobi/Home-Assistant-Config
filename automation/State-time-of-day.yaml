###
# Control Time of Day
###
- id: '7'
  alias: 'Set Time of Day to Morning'
  trigger:
    - entity_id: binary_sensor.dining_room_stairs_motion_sensor_sensor, binary_sensor.tv_area_motion_sensor_sensor
      platform: state
      to: 'on'
    - platform: state
      entity_id: input_boolean.sleep_state_tor, input_boolean.sleep_state_lande, input_boolean.sleep_state_ingrid, input_boolean.sleep_state_guests
      to: 'off'
    - platform: time
      at: '08:45:00'   
  condition:
    condition: and
    conditions:
      - condition: time
        after: '05:30:00'
        before: '12:00:00'
      - condition: state
        entity_id: input_select.time_of_day
        state: 'Night'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.time_of_day
        option: Morning

- id: '8'
  alias: 'Set Time of Day to Day'
  trigger:
    - platform: time
      at: '09:00:00'   
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.time_of_day
        option: Day

- id: '9'
  alias: 'Set Time of Day to Evening'
  trigger:
    - platform: time
      at: '19:30:00'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.time_of_day
        option: Evening

- id: '10'
  alias: 'Set Time of Day to Night'
  trigger:
    - platform: state
      entity_id: input_boolean.sleep_state_tor, input_boolean.sleep_state_lande, input_boolean.sleep_state_ingrid, input_boolean.sleep_state_guests
      to: 'on'
    - platform: time
      at: '23:00:00'
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: input_select.home_state
        state: 'Away'
      - condition: and
        conditions:
          - condition: template
            value_template: '{{(not is_state("device_tracker.google_maps_117621586906275495071", "home") or is_state("input_boolean.sleep_state_tor", "on"))}}'
          - condition: template
            value_template: '{{(not is_state("device_tracker.google_maps_106703534047375134126", "home") or is_state("input_boolean.sleep_state_lande", "on"))}}'
          - condition: template
            value_template: '{{(not is_state("device_tracker.ipad__ingrid", "home") or is_state("input_boolean.sleep_state_ingrid", "on"))}}'
          - condition: template
            value_template: '{{(is_state("input_boolean.guests_present", "on") and is_state("input_boolean.sleep_state_guests", "on")) or is_state("input_boolean.guests_present","off")}}'
  action:
    - service: input_select.select_option
      data:
        entity_id: input_select.time_of_day
        option: Night
